Use 4 GPUs!
{'train': 'Num of clips:2284', 'val': 'Num of clips:910'}
Epoch 0/19
----------
train Loss: 3.0483 Acc: 0.1353
val Loss: 2.8234 Acc: 0.2396

Epoch 1/19
----------
train Loss: 2.5416 Acc: 0.3730
val Loss: 2.4490 Acc: 0.3890

Epoch 2/19
----------
train Loss: 2.0652 Acc: 0.5219
val Loss: 2.0748 Acc: 0.4780

Epoch 3/19
----------
train Loss: 1.6661 Acc: 0.6309
val Loss: 1.7865 Acc: 0.5363

Epoch 4/19
----------
train Loss: 1.3458 Acc: 0.6944
val Loss: 1.5226 Acc: 0.6022

Epoch 5/19
----------
train Loss: 1.0441 Acc: 0.7719
val Loss: 1.3895 Acc: 0.6253

Epoch 6/19
----------
train Loss: 0.8112 Acc: 0.8424
val Loss: 1.2556 Acc: 0.6451

Epoch 7/19
----------
train Loss: 0.6360 Acc: 0.8778
val Loss: 1.1667 Acc: 0.6615

Epoch 8/19
----------
train Loss: 0.5127 Acc: 0.9133
val Loss: 1.1632 Acc: 0.6692

Epoch 9/19
----------
train Loss: 0.3933 Acc: 0.9330
val Loss: 1.0987 Acc: 0.6780

Epoch 10/19
----------
train Loss: 0.3234 Acc: 0.9510
val Loss: 1.1006 Acc: 0.6769

Epoch 11/19
----------
train Loss: 0.2576 Acc: 0.9645
val Loss: 1.0459 Acc: 0.6857

Epoch 12/19
----------
train Loss: 0.2131 Acc: 0.9759
val Loss: 1.0048 Acc: 0.6978

Epoch 13/19
----------
train Loss: 0.1564 Acc: 0.9869
val Loss: 0.9862 Acc: 0.7143

Epoch 14/19
----------
train Loss: 0.1285 Acc: 0.9917
val Loss: 0.9619 Acc: 0.7110

Epoch 15/19
----------
train Loss: 0.1099 Acc: 0.9912
val Loss: 1.0502 Acc: 0.6802

Epoch 16/19
----------
train Loss: 0.0972 Acc: 0.9943
val Loss: 0.9669 Acc: 0.7165

Epoch 17/19
----------
train Loss: 0.0861 Acc: 0.9943
val Loss: 0.9363 Acc: 0.7154

Epoch 18/19
----------
train Loss: 0.0684 Acc: 0.9965
val Loss: 0.9922 Acc: 0.7033

Epoch 19/19
----------
train Loss: 0.0678 Acc: 0.9965
val Loss: 0.9660 Acc: 0.7077

Training complete in 17m 50s
Best val Acc: 0.716484
Saved the weights of the best epoch in /home/acb11711tx/lzq/ExpEval/model_param/ucf101_24_r2p1d_16_Full_grad_cam_0.05_kar_LongRange.pt
Num of clips:910
 Val: Acc@1 71.648 Acc@5 94.396

Normalized confusion matrix
Traceback (most recent call last):
  File "model_train/retrain_ucf101_24_model.py", line 172, in <module>
    cm_fig.savefig(os.path.join(proj_root, 'visual_res', 'cm', f'{save_label}.png'))
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/figure.py", line 2062, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backend_bases.py", line 2263, in print_figure
    **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backends/backend_agg.py", line 530, in print_png
    with cbook.open_file_cm(filename_or_obj, "wb") as fh:
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 626, in open_file_cm
    fh, opened = to_filehandle(path_or_file, mode, True, encoding)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 611, in to_filehandle
    fh = io.open(fname, flag, encoding=encoding)
FileNotFoundError: [Errno 2] No such file or directory: '/home/acb11711tx/lzq/ExpEval/visual_res/cm/ucf101_24_r2p1d_16_Full_grad_cam_0.05_kar_LongRange.png'

Use 4 GPUs!
{'train': 'Num of clips:2284', 'val': 'Num of clips:910'}
Epoch 0/19
----------
train Loss: 3.0135 Acc: 0.1537
val Loss: 2.6842 Acc: 0.3176

Epoch 1/19
----------
train Loss: 2.3679 Acc: 0.4750
val Loss: 2.1319 Acc: 0.4967

Epoch 2/19
----------
train Loss: 1.7775 Acc: 0.6419
val Loss: 1.6434 Acc: 0.6077

Epoch 3/19
----------
train Loss: 1.3189 Acc: 0.7456
val Loss: 1.2901 Acc: 0.6879

Epoch 4/19
----------
train Loss: 0.9294 Acc: 0.8257
val Loss: 1.0512 Acc: 0.7363

Epoch 5/19
----------
train Loss: 0.6825 Acc: 0.8831
val Loss: 0.9276 Acc: 0.7615

Epoch 6/19
----------
train Loss: 0.5079 Acc: 0.9129
val Loss: 0.8359 Acc: 0.7813

Epoch 7/19
----------
train Loss: 0.3871 Acc: 0.9448
val Loss: 0.7482 Acc: 0.7967

Epoch 8/19
----------
train Loss: 0.3168 Acc: 0.9597
val Loss: 0.7294 Acc: 0.8033

Epoch 9/19
----------
train Loss: 0.2296 Acc: 0.9785
val Loss: 0.6750 Acc: 0.8110

Epoch 10/19
----------
train Loss: 0.1891 Acc: 0.9834
val Loss: 0.6397 Acc: 0.8176

Epoch 11/19
----------
train Loss: 0.1512 Acc: 0.9882
val Loss: 0.6572 Acc: 0.8143

Epoch 12/19
----------
train Loss: 0.1243 Acc: 0.9912
val Loss: 0.6295 Acc: 0.8220

Epoch 13/19
----------
train Loss: 0.1123 Acc: 0.9917
val Loss: 0.6097 Acc: 0.8209

Epoch 14/19
----------
train Loss: 0.0962 Acc: 0.9939
val Loss: 0.5820 Acc: 0.8319

Epoch 15/19
----------
train Loss: 0.0761 Acc: 0.9956
val Loss: 0.5897 Acc: 0.8319

Epoch 16/19
----------
train Loss: 0.0663 Acc: 0.9982
val Loss: 0.5755 Acc: 0.8308

Epoch 17/19
----------
train Loss: 0.0639 Acc: 0.9978
val Loss: 0.5922 Acc: 0.8242

Epoch 18/19
----------
train Loss: 0.0597 Acc: 0.9956
val Loss: 0.5607 Acc: 0.8352

Epoch 19/19
----------
train Loss: 0.0485 Acc: 0.9978
val Loss: 0.5521 Acc: 0.8418

Training complete in 17m 46s
Best val Acc: 0.841758
Saved the weights of the best epoch in /home/acb11711tx/lzq/ExpEval/model_param/ucf101_24_r2p1d_16_Full_grad_cam_0.1_kar_LongRange.pt
Num of clips:910
 Val: Acc@1 84.176 Acc@5 97.033

Normalized confusion matrix
Traceback (most recent call last):
  File "model_train/retrain_ucf101_24_model.py", line 172, in <module>
    cm_fig.savefig(os.path.join(proj_root, 'visual_res', 'cm', f'{save_label}.png'))
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/figure.py", line 2062, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backend_bases.py", line 2263, in print_figure
    **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backends/backend_agg.py", line 530, in print_png
    with cbook.open_file_cm(filename_or_obj, "wb") as fh:
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 626, in open_file_cm
    fh, opened = to_filehandle(path_or_file, mode, True, encoding)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 611, in to_filehandle
    fh = io.open(fname, flag, encoding=encoding)
FileNotFoundError: [Errno 2] No such file or directory: '/home/acb11711tx/lzq/ExpEval/visual_res/cm/ucf101_24_r2p1d_16_Full_grad_cam_0.1_kar_LongRange.png'
Use 4 GPUs!
{'train': 'Num of clips:2284', 'val': 'Num of clips:910'}
Epoch 0/19
----------
train Loss: 2.9375 Acc: 0.2347
val Loss: 2.4418 Acc: 0.5659

Epoch 1/19
----------
train Loss: 1.9836 Acc: 0.6839
val Loss: 1.5102 Acc: 0.7637

Epoch 2/19
----------
train Loss: 1.2023 Acc: 0.8669
val Loss: 0.8976 Acc: 0.8725

Epoch 3/19
----------
train Loss: 0.7293 Acc: 0.9238
val Loss: 0.6125 Acc: 0.8956

Epoch 4/19
----------
train Loss: 0.4694 Acc: 0.9545
val Loss: 0.4518 Acc: 0.9110

Epoch 5/19
----------
train Loss: 0.3286 Acc: 0.9707
val Loss: 0.3835 Acc: 0.9198

Epoch 6/19
----------
train Loss: 0.2510 Acc: 0.9764
val Loss: 0.3277 Acc: 0.9253

Epoch 7/19
----------
train Loss: 0.1817 Acc: 0.9869
val Loss: 0.2938 Acc: 0.9297

Epoch 8/19
----------
train Loss: 0.1598 Acc: 0.9886
val Loss: 0.2683 Acc: 0.9341

Epoch 9/19
----------
train Loss: 0.1301 Acc: 0.9921
val Loss: 0.2586 Acc: 0.9352

Epoch 10/19
----------
train Loss: 0.1101 Acc: 0.9956
val Loss: 0.2565 Acc: 0.9286

Epoch 11/19
----------
train Loss: 0.0878 Acc: 0.9978
val Loss: 0.2329 Acc: 0.9341

Epoch 12/19
----------
train Loss: 0.0851 Acc: 0.9956
val Loss: 0.2077 Acc: 0.9396

Epoch 13/19
----------
train Loss: 0.0719 Acc: 0.9969
val Loss: 0.2021 Acc: 0.9440

Epoch 14/19
----------
train Loss: 0.0646 Acc: 0.9952
val Loss: 0.1986 Acc: 0.9451

Epoch 15/19
----------
train Loss: 0.0616 Acc: 0.9978
val Loss: 0.1981 Acc: 0.9396

Epoch 16/19
----------
train Loss: 0.0485 Acc: 0.9987
val Loss: 0.2001 Acc: 0.9407

Epoch 17/19
----------
train Loss: 0.0490 Acc: 0.9978
val Loss: 0.1897 Acc: 0.9462

Epoch 18/19
----------
train Loss: 0.0424 Acc: 0.9987
val Loss: 0.1948 Acc: 0.9451

Epoch 19/19
----------
train Loss: 0.0408 Acc: 0.9982
val Loss: 0.1824 Acc: 0.9462

Training complete in 17m 27s
Best val Acc: 0.946154
Saved the weights of the best epoch in /home/acb11711tx/lzq/ExpEval/model_param/ucf101_24_r2p1d_16_Full_grad_cam_0.3_kar_LongRange.pt
Num of clips:910
 Val: Acc@1 94.615 Acc@5 99.560

Normalized confusion matrix
Traceback (most recent call last):
  File "model_train/retrain_ucf101_24_model.py", line 172, in <module>
    cm_fig.savefig(os.path.join(proj_root, 'visual_res', 'cm', f'{save_label}.png'))
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/figure.py", line 2062, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backend_bases.py", line 2263, in print_figure
    **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backends/backend_agg.py", line 530, in print_png
    with cbook.open_file_cm(filename_or_obj, "wb") as fh:
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 626, in open_file_cm
    fh, opened = to_filehandle(path_or_file, mode, True, encoding)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 611, in to_filehandle
    fh = io.open(fname, flag, encoding=encoding)
FileNotFoundError: [Errno 2] No such file or directory: '/home/acb11711tx/lzq/ExpEval/visual_res/cm/ucf101_24_r2p1d_16_Full_grad_cam_0.3_kar_LongRange.png'
Use 4 GPUs!
{'train': 'Num of clips:2284', 'val': 'Num of clips:910'}
Epoch 0/19
----------
train Loss: 2.8846 Acc: 0.2627
val Loss: 2.2782 Acc: 0.6000

Epoch 1/19
----------
train Loss: 1.8241 Acc: 0.7693
val Loss: 1.2437 Acc: 0.8549

Epoch 2/19
----------
train Loss: 0.9834 Acc: 0.9335
val Loss: 0.6871 Acc: 0.9088

Epoch 3/19
----------
train Loss: 0.5583 Acc: 0.9606
val Loss: 0.4355 Acc: 0.9341

Epoch 4/19
----------
train Loss: 0.3595 Acc: 0.9685
val Loss: 0.3319 Acc: 0.9440

Epoch 5/19
----------
train Loss: 0.2689 Acc: 0.9781
val Loss: 0.2717 Acc: 0.9451

Epoch 6/19
----------
train Loss: 0.2019 Acc: 0.9856
val Loss: 0.2377 Acc: 0.9527

Epoch 7/19
----------
train Loss: 0.1559 Acc: 0.9917
val Loss: 0.2100 Acc: 0.9560

Epoch 8/19
----------
train Loss: 0.1252 Acc: 0.9934
val Loss: 0.1933 Acc: 0.9604

Epoch 9/19
----------
train Loss: 0.1041 Acc: 0.9952
val Loss: 0.1832 Acc: 0.9626

Epoch 10/19
----------
train Loss: 0.0925 Acc: 0.9956
val Loss: 0.1825 Acc: 0.9538

Epoch 11/19
----------
train Loss: 0.0834 Acc: 0.9978
val Loss: 0.1652 Acc: 0.9648

Epoch 12/19
----------
train Loss: 0.0758 Acc: 0.9965
val Loss: 0.1601 Acc: 0.9626

Epoch 13/19
----------
train Loss: 0.0662 Acc: 0.9978
val Loss: 0.1505 Acc: 0.9615

Epoch 14/19
----------
train Loss: 0.0580 Acc: 0.9982
val Loss: 0.1533 Acc: 0.9648

Epoch 15/19
----------
train Loss: 0.0529 Acc: 0.9982
val Loss: 0.1490 Acc: 0.9681

Epoch 16/19
----------
train Loss: 0.0464 Acc: 0.9987
val Loss: 0.1488 Acc: 0.9670

Epoch 17/19
----------
train Loss: 0.0494 Acc: 0.9978
val Loss: 0.1321 Acc: 0.9714

Epoch 18/19
----------
train Loss: 0.0372 Acc: 0.9991
val Loss: 0.1314 Acc: 0.9659

Epoch 19/19
----------
train Loss: 0.0379 Acc: 0.9991
val Loss: 0.1362 Acc: 0.9659

Training complete in 17m 37s
Best val Acc: 0.971429
Saved the weights of the best epoch in /home/acb11711tx/lzq/ExpEval/model_param/ucf101_24_r2p1d_16_Full_grad_cam_0.5_kar_LongRange.pt
Num of clips:910
 Val: Acc@1 97.143 Acc@5 99.780

Normalized confusion matrix
Traceback (most recent call last):
  File "model_train/retrain_ucf101_24_model.py", line 172, in <module>
    cm_fig.savefig(os.path.join(proj_root, 'visual_res', 'cm', f'{save_label}.png'))
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/figure.py", line 2062, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backend_bases.py", line 2263, in print_figure
    **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backends/backend_agg.py", line 530, in print_png
    with cbook.open_file_cm(filename_or_obj, "wb") as fh:
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 626, in open_file_cm
    fh, opened = to_filehandle(path_or_file, mode, True, encoding)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 611, in to_filehandle
    fh = io.open(fname, flag, encoding=encoding)
FileNotFoundError: [Errno 2] No such file or directory: '/home/acb11711tx/lzq/ExpEval/visual_res/cm/ucf101_24_r2p1d_16_Full_grad_cam_0.5_kar_LongRange.png'
Use 4 GPUs!
{'train': 'Num of clips:2284', 'val': 'Num of clips:910'}
Epoch 0/19
----------
train Loss: 2.8054 Acc: 0.3192
val Loss: 2.1245 Acc: 0.6571

Epoch 1/19
----------
train Loss: 1.6780 Acc: 0.8183
val Loss: 1.0491 Acc: 0.9143

Epoch 2/19
----------
train Loss: 0.8785 Acc: 0.9470
val Loss: 0.5420 Acc: 0.9429

Epoch 3/19
----------
train Loss: 0.4999 Acc: 0.9654
val Loss: 0.3465 Acc: 0.9495

Epoch 4/19
----------
train Loss: 0.3141 Acc: 0.9829
val Loss: 0.2927 Acc: 0.9549

Epoch 5/19
----------
train Loss: 0.2340 Acc: 0.9847
val Loss: 0.2504 Acc: 0.9560

Epoch 6/19
----------
train Loss: 0.1831 Acc: 0.9847
val Loss: 0.2122 Acc: 0.9549

Epoch 7/19
----------
train Loss: 0.1435 Acc: 0.9926
val Loss: 0.2054 Acc: 0.9582

Epoch 8/19
----------
train Loss: 0.1208 Acc: 0.9895
val Loss: 0.1749 Acc: 0.9670

Epoch 9/19
----------
train Loss: 0.1110 Acc: 0.9921
val Loss: 0.1653 Acc: 0.9648

Epoch 10/19
----------
train Loss: 0.0919 Acc: 0.9956
val Loss: 0.1533 Acc: 0.9659

Epoch 11/19
----------
train Loss: 0.0836 Acc: 0.9952
val Loss: 0.1445 Acc: 0.9714

Epoch 12/19
----------
train Loss: 0.0671 Acc: 0.9982
val Loss: 0.1347 Acc: 0.9692

Epoch 13/19
----------
train Loss: 0.0671 Acc: 0.9969
val Loss: 0.1405 Acc: 0.9670

Epoch 14/19
----------
train Loss: 0.0581 Acc: 0.9969
val Loss: 0.1390 Acc: 0.9637

Epoch 15/19
----------
train Loss: 0.0527 Acc: 0.9987
val Loss: 0.1168 Acc: 0.9758

Epoch 16/19
----------
train Loss: 0.0516 Acc: 0.9987
val Loss: 0.1295 Acc: 0.9670

Epoch 17/19
----------
train Loss: 0.0482 Acc: 0.9969
val Loss: 0.1268 Acc: 0.9648

Epoch 18/19
----------
train Loss: 0.0416 Acc: 0.9987
val Loss: 0.1146 Acc: 0.9747

Epoch 19/19
----------
train Loss: 0.0395 Acc: 0.9978
val Loss: 0.1188 Acc: 0.9681

Training complete in 17m 26s
Best val Acc: 0.975824
Saved the weights of the best epoch in /home/acb11711tx/lzq/ExpEval/model_param/ucf101_24_r2p1d_16_Full_grad_cam_0.7_kar_LongRange.pt
Num of clips:910
 Val: Acc@1 97.582 Acc@5 99.890

Normalized confusion matrix
Traceback (most recent call last):
  File "model_train/retrain_ucf101_24_model.py", line 172, in <module>
    cm_fig.savefig(os.path.join(proj_root, 'visual_res', 'cm', f'{save_label}.png'))
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/figure.py", line 2062, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backend_bases.py", line 2263, in print_figure
    **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backends/backend_agg.py", line 530, in print_png
    with cbook.open_file_cm(filename_or_obj, "wb") as fh:
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 626, in open_file_cm
    fh, opened = to_filehandle(path_or_file, mode, True, encoding)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 611, in to_filehandle
    fh = io.open(fname, flag, encoding=encoding)
FileNotFoundError: [Errno 2] No such file or directory: '/home/acb11711tx/lzq/ExpEval/visual_res/cm/ucf101_24_r2p1d_16_Full_grad_cam_0.7_kar_LongRange.png'
Use 4 GPUs!
{'train': 'Num of clips:2284', 'val': 'Num of clips:910'}
Epoch 0/19
----------
train Loss: 2.7380 Acc: 0.3612
val Loss: 1.9871 Acc: 0.7143

Epoch 1/19
----------
train Loss: 1.5483 Acc: 0.8647
val Loss: 0.8978 Acc: 0.9044

Epoch 2/19
----------
train Loss: 0.7835 Acc: 0.9470
val Loss: 0.4605 Acc: 0.9451

Epoch 3/19
----------
train Loss: 0.4473 Acc: 0.9694
val Loss: 0.3074 Acc: 0.9516

Epoch 4/19
----------
train Loss: 0.3018 Acc: 0.9781
val Loss: 0.2416 Acc: 0.9604

Epoch 5/19
----------
train Loss: 0.2283 Acc: 0.9847
val Loss: 0.2000 Acc: 0.9670

Epoch 6/19
----------
train Loss: 0.1766 Acc: 0.9904
val Loss: 0.1872 Acc: 0.9582

Epoch 7/19
----------
train Loss: 0.1415 Acc: 0.9921
val Loss: 0.1670 Acc: 0.9615

Epoch 8/19
----------
train Loss: 0.1180 Acc: 0.9921
val Loss: 0.1402 Acc: 0.9681

Epoch 9/19
----------
train Loss: 0.1061 Acc: 0.9930
val Loss: 0.1354 Acc: 0.9692

Epoch 10/19
----------
train Loss: 0.0925 Acc: 0.9934
val Loss: 0.1217 Acc: 0.9714

Epoch 11/19
----------
train Loss: 0.0860 Acc: 0.9947
val Loss: 0.1301 Acc: 0.9670

Epoch 12/19
----------
train Loss: 0.0694 Acc: 0.9974
val Loss: 0.1217 Acc: 0.9670

Epoch 13/19
----------
train Loss: 0.0650 Acc: 0.9978
val Loss: 0.1216 Acc: 0.9681

Epoch 14/19
----------
train Loss: 0.0594 Acc: 0.9974
val Loss: 0.1146 Acc: 0.9681

Epoch 15/19
----------
train Loss: 0.0545 Acc: 0.9969
val Loss: 0.1006 Acc: 0.9736

Epoch 16/19
----------
train Loss: 0.0498 Acc: 0.9987
val Loss: 0.1093 Acc: 0.9659

Epoch 17/19
----------
train Loss: 0.0480 Acc: 0.9982
val Loss: 0.1080 Acc: 0.9692

Epoch 18/19
----------
train Loss: 0.0441 Acc: 0.9991
val Loss: 0.1066 Acc: 0.9714

Epoch 19/19
----------
train Loss: 0.0393 Acc: 0.9987
val Loss: 0.1005 Acc: 0.9703

Training complete in 17m 27s
Best val Acc: 0.973626
Saved the weights of the best epoch in /home/acb11711tx/lzq/ExpEval/model_param/ucf101_24_r2p1d_16_Full_grad_cam_0.9_kar_LongRange.pt
Num of clips:910
 Val: Acc@1 97.363 Acc@5 99.890

Normalized confusion matrix
Traceback (most recent call last):
  File "model_train/retrain_ucf101_24_model.py", line 172, in <module>
    cm_fig.savefig(os.path.join(proj_root, 'visual_res', 'cm', f'{save_label}.png'))
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/figure.py", line 2062, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backend_bases.py", line 2263, in print_figure
    **kwargs)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/backends/backend_agg.py", line 530, in print_png
    with cbook.open_file_cm(filename_or_obj, "wb") as fh:
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 626, in open_file_cm
    fh, opened = to_filehandle(path_or_file, mode, True, encoding)
  File "/home/acb11711tx/miniconda3/envs/pytorch1.1/lib/python3.6/site-packages/matplotlib/cbook/__init__.py", line 611, in to_filehandle
    fh = io.open(fname, flag, encoding=encoding)
FileNotFoundError: [Errno 2] No such file or directory: '/home/acb11711tx/lzq/ExpEval/visual_res/cm/ucf101_24_r2p1d_16_Full_grad_cam_0.9_kar_LongRange.png'
